{% extends "base.html" %}
{% load i18n static %}

{% block title %}{{ site_settings.meta_title|default:"CodexDLC — Ваш бизнес. Наш IT-движок." }}{% endblock %}
{% block og_title %}{{ site_settings.meta_title|default:"CodexDLC — Ваш бизнес. Наш IT-движок." }}{% endblock %}
{% block twitter_title %}{{ site_settings.meta_title|default:"CodexDLC" }}{% endblock %}

{% block meta_extra %}{% include "includes/_schema_local_business.html" %}{% endblock %}

{% block content %}

{# ======================== BLOCK 1: HERO ======================== #}
<section class="hero" id="hero-section">
    <div class="hero-bg"></div>
    <div class="hero-torch" id="hero-torch"></div>
    <div class="container hero-content">
        <span class="tech-label">{{ content.home_hero_label|default:_("home_hero_label") }}</span>
        <h1 class="hero-title">
            {{ content.home_hero_title|default:_("home_hero_title")|linebreaksbr }}
        </h1>
        <p class="hero-subtitle">
            {{ content.home_hero_subtitle|default:_("home_hero_subtitle") }}
        </p>
        <div class="hero-actions">
            {% if site_settings.site_mode == 'sales' %}
            <a href="{% url 'main:services_waas' %}" class="btn btn-primary">
                {{ content.home_hero_cta_primary_sales }}</a>
            <a href="{% url 'main:contacts' %}" class="btn btn-secondary">
                {{ content.home_hero_cta_secondary_sales }}</a>
            {% else %}
            <a href="#survey" class="btn btn-primary">{{ content.home_hero_cta_primary_research }}</a>
            <a href="#services" class="btn btn-secondary">{{ content.home_hero_cta_secondary_research }}</a>
            {% endif %}
        </div>
    </div>
</section>

{# ======================== BLOCK 2: PROBLEM vs SOLUTION ======================== #}
<section class="section">
    <div class="container">
        <span class="tech-label">{{ content.home_compare_label|default:_("home_compare_label") }}</span>
        <h2 class="section-title">{{ content.home_compare_title|default:_("home_compare_title") }}</h2>
        <div class="contrast-grid">
            <div class="contrast-card">
                <h4 class="gray-600">CLASSIC_AGENCIES</h4>
                <ul class="contrast-list">
                    <li>{{ content.home_compare_classic_1|default:_("home_compare_classic_1") }}</li>
                    <li>{{ content.home_compare_classic_2|default:_("home_compare_classic_2") }}</li>
                    <li>{{ content.home_compare_classic_3|default:_("home_compare_classic_3") }}</li>
                    <li>{{ content.home_compare_classic_4|default:_("home_compare_classic_4") }}</li>
                </ul>
            </div>
            <div class="contrast-card active">
                <h4 class="cyber-blue">CODEXDLC_SUBSCRIPTION</h4>
                <ul class="contrast-list">
                    <li>{{ content.home_compare_codex_1|default:_("home_compare_codex_1") }}</li>
                    <li>{{ content.home_compare_codex_2|default:_("home_compare_codex_2") }}</li>
                    <li>{{ content.home_compare_codex_3|default:_("home_compare_codex_3") }}</li>
                    <li>{{ content.home_compare_codex_4|default:_("home_compare_codex_4") }}</li>
                </ul>
            </div>
        </div>
    </div>
</section>

<div class="section-divider"></div>

{# ======================== BLOCK 3: Z-PATTERN SERVICES ======================== #}
<section id="services" class="z-section">
    <div class="container">
        <span class="tech-label">{{ content.home_services_label|default:_("home_services_label") }}</span>
        <h2 class="section-title text-left">{{ content.home_services_title|default:_("home_services_title") }}</h2>

        {# 3.1 WaaS #}
        <div class="z-row">
            <div class="z-text-block">
                <div>
                    <span class="tech-label">01 // WEBSITE AS A SERVICE</span>
                    <h2>{{ content.home_service_waas_title|default:_("home_service_waas_title") }}</h2>
                </div>
                <p>{{ content.home_service_waas_desc }}</p>
                <ul class="contrast-list">
                    <li>{{ content.home_service_waas_feat_1|default:_("home_service_waas_feat_1") }}</li>
                    <li>{{ content.home_service_waas_feat_2|default:_("home_service_waas_feat_2") }}</li>
                    <li>{{ content.home_service_waas_feat_3|default:_("home_service_waas_feat_3") }}</li>
                    <li>{{ content.home_service_waas_feat_4|default:_("home_service_waas_feat_4") }}</li>
                </ul>
                <a href="{% url 'main:services_waas' %}" class="z-link">
                    {{ content.btn_action_more|default:_("btn_action_more") }} &nbsp;→</a>
            </div>
            <div class="z-visual">
                <div class="z-visual-accent"></div>
                <div class="text-center z-idx-1">
                    <div class="z-preview-label">[ LILY_SALON_PREVIEW ]</div>
                    <div class="z-waas-grid">
                        <div class="z-waas-item"></div>
                        <div class="z-waas-item"></div>
                        <div class="z-waas-item wide"></div>
                        <div class="z-waas-accent"></div>
                    </div>
                </div>
            </div>
        </div>

        {# 3.2 Telegram Bots #}
        <div class="z-row reverse">
            <div class="z-text-block">
                <div>
                    <span class="tech-label">02 // AUTOMATION</span>
                    <h2>{{ content.home_service_bot_title|default:_("home_service_bot_title") }}</h2>
                </div>
                <p>{{ content.home_service_bot_desc }}</p>
                <ul class="contrast-list">
                    <li>{{ content.home_service_bot_feat_1|default:_("home_service_bot_feat_1") }}</li>
                    <li>{{ content.home_service_bot_feat_2|default:_("home_service_bot_feat_2") }}</li>
                    <li>{{ content.home_service_bot_feat_3|default:_("home_service_bot_feat_3") }}</li>
                    <li>{{ content.home_service_bot_feat_4|default:_("home_service_bot_feat_4") }}</li>
                </ul>
                <a href="{% url 'main:services_automation' %}" class="z-link">
                    {{ content.btn_action_more|default:_("btn_action_more") }} &nbsp;→</a>
            </div>
            <div class="z-visual blue-accent">
                <div class="z-visual-accent"></div>
                <div class="padding-lg z-idx-1 w-full">
                    <div class="bot-demo-inner">
                        <div class="z-preview-label">TELEGRAM_BOT // ACTIVE</div>
                        <div class="flex flex-col gap-sm">
                            <div class="bot-msg user">{{ content.home_service_bot_demo_user }}</div>
                            <div class="bot-msg admin">{{ content.home_service_bot_demo_bot }}</div>
                            <div class="bot-status-wrap">
                                <span class="status-dot-no-margin"></span>
                                <span class="bot-status-text">NEW_LEAD // ADMIN_NOTIFIED</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        {# 3.3 Prototypes #}
        <div class="z-row">
            <div class="z-text-block">
                <div>
                    <span class="tech-label">03 // PLUG & PLAY</span>
                    <h2>{{ content.home_service_proto_title|default:_("home_service_proto_title") }}</h2>
                </div>
                <p>{{ content.home_service_proto_desc }}</p>
                <ul class="contrast-list">
                    <li>{{ content.home_service_proto_feat_1|default:_("home_service_proto_feat_1") }}</li>
                    <li>{{ content.home_service_proto_feat_2|default:_("home_service_proto_feat_2") }}</li>
                    <li>{{ content.home_service_proto_feat_3|default:_("home_service_proto_feat_3") }}</li>
                    <li>{{ content.home_service_proto_feat_4|default:_("home_service_proto_feat_4") }}</li>
                </ul>
                <a href="{% url 'main:services_prototype' %}" class="z-link">
                    {{ content.nav_main_prototypes|default:_("nav_main_prototypes") }} &nbsp;→</a>
            </div>
            <div class="z-visual">
                <div class="z-visual-accent"></div>
                <div class="padding-lg z-idx-1 w-full">
                    <div class="proto-grid">
                        <div class="proto-item">LILY<br>SALON</div>
                        <div class="proto-item">DLC<br>MONTAGE</div>
                        <div class="proto-item active">AUTO<br>HUB</div>
                        <div class="proto-item wide">BUILDER PRO // CONSTRUCTION</div>
                    </div>
                </div>
            </div>
        </div>

    </div>
</section>

<div class="section-divider"></div>

{# ======================== BLOCK 4: TRUST / ARCHITECTURE ======================== #}
<section class="section">
    <div class="container">
        <span class="tech-label">{{ content.home_trust_kicker|default:_("home_trust_kicker") }}</span>
        <h2 class="section-title text-left">{{ content.home_trust_title|default:_("home_trust_title") }}</h2>
        <p class="section-description">{{ content.home_trust_text|default:_("home_trust_text") }}</p>
        <div class="bento-grid">
            <div class="bento-card col-span-3 metric-card">
                <div class="metric-value status-green">100% DSGVO</div>
                <p class="metric-label">{{ content.home_trust_metric_1_label|default:_("home_trust_metric_1_label") }}
                </p>
            </div>
            <div class="bento-card col-span-3 metric-card">
                <div class="metric-value cyber-blue">99.9% Uptime</div>
                <p class="metric-label">{{ content.home_trust_metric_2_label|default:_("home_trust_metric_2_label") }}
                </p>
            </div>
            <div class="bento-card col-span-3 metric-card">
                <div class="metric-value electric-purple">100 / 100</div>
                <p class="metric-label">{{ content.home_trust_metric_3_label|default:_("home_trust_metric_3_label") }}
                </p>
            </div>
            <div class="bento-card col-span-3 metric-card">
                <div class="metric-value gray-300">EU Hosting</div>
                <p class="metric-label">{{ content.home_trust_metric_4_label|default:_("home_trust_metric_4_label") }}
                </p>
            </div>
        </div>
    </div>
</section>

<div class="section-divider"></div>

{# ======================== BLOCK 5: TECH CORNER ======================== #}
<section class="section">
    <div class="container">
        <span class="tech-label">{{ content.home_tech_label|default:_("home_tech_label") }}</span>
        <h2 class="section-title text-left">{{ content.home_tech_title|default:_("home_tech_title") }}</h2>
        <p class="section-description">{{ content.home_tech_subtitle|default:_("home_tech_subtitle") }}</p>
        <div class="tech-bento">
            <div class="bento-card col-span-5">
                <span class="tech-label">{{ content.home_tech_arch_label|default:"SYSTEM_ARCHITECT" }}</span>
                <h3 class="card-title">{{ content.home_tech_arch_title|default:_("home_tech_arch_title") }}</h3>
                <p class="card-description">{{ content.home_tech_arch_desc|default:_("home_tech_arch_desc") }}</p>
                <div class="card-footer">DACH_REGION // EST. 2024</div>
            </div>
            <div class="bento-card col-span-7">
                <span class="tech-label">{{ content.home_tech_stack_label|default:"TECH_STACK" }}</span>
                <div class="tech-stack">
                    <span class="tech-badge active">Python</span>
                    <span class="tech-badge active">Django</span>
                    <span class="tech-badge active">FastAPI</span>
                    <span class="tech-badge active">HTMX</span>
                    <span class="tech-badge">Docker</span>
                    <span class="tech-badge">PostgreSQL</span>
                    <span class="tech-badge">Redis</span>
                    <span class="tech-badge">Aiogram</span>
                    <span class="tech-badge">Nginx</span>
                    <span class="tech-badge">CI/CD</span>
                </div>
                <div class="benchmark-card">
                    <div class="benchmark-header">// performance benchmark</div>
                    <div class="benchmark-list">
                        <div>
                            <div class="benchmark-val cyber-blue">&lt;200ms</div>
                            <div class="benchmark-label">Time to First Byte</div>
                        </div>
                        <div>
                            <div class="benchmark-val status-green">99.9%</div>
                            <div class="benchmark-label">Uptime SLA</div>
                        </div>
                        <div>
                            <div class="benchmark-val electric-purple">100</div>
                            <div class="benchmark-label">Lighthouse Score</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<div class="section-divider"></div>

{# ======================== BLOCK 6: PORTFOLIO MARQUEE ======================== #}
<section class="padding-vertical-lg">
    <div class="marquee">
        <div class="marquee-content">
            <span class="marquee-item">LILY SALON</span>
            <span class="marquee-item gray-600">//</span>
            <span class="marquee-item">DLC MONTAGE</span>
            <span class="marquee-item gray-600">//</span>
            <span class="marquee-item">BUILDER PRO</span>
            <span class="marquee-item gray-600">//</span>
            <span class="marquee-item">AUTO SERVICE HUB</span>
            <span class="marquee-item gray-600">//</span>
            <span class="marquee-item">LILY SALON</span>
            <span class="marquee-item gray-600">//</span>
            <span class="marquee-item">DLC MONTAGE</span>
            <span class="marquee-item gray-600">//</span>
            <span class="marquee-item">BUILDER PRO</span>
            <span class="marquee-item gray-600">//</span>
            <span class="marquee-item">AUTO SERVICE HUB</span>
            <span class="marquee-item gray-600">//</span>
        </div>
    </div>
</section>

{# ======================== BLOCK 7: FINAL FUNNEL (CTA, dual-mode) ======================== #}
<section class="section funnel-section">
    <div class="container narrow text-center">
        <span class="tech-label">{{ content.home_cta_kicker|default:_("home_cta_kicker") }}</span>
        {% if site_settings.site_mode == 'sales' %}
        <h2 class="funnel-title">{{ content.home_cta_sales_title }}</h2>
        <p class="funnel-text">{{ content.home_cta_sales_text }}</p>
        <div class="hero-actions justify-center">
            <a href="{% url 'main:services_waas' %}" class="btn btn-primary">
                {{ content.home_cta_sales_btn_primary }}</a>
            <a href="{% url 'main:contacts' %}" class="btn btn-secondary">{{ content.home_cta_sales_btn_secondary }}</a>
        </div>
        {% else %}
        <h2 class="funnel-title">{{ content.home_cta_research_title }}</h2>
        <p class="funnel-text">{{ content.home_cta_research_text }}</p>
        <div class="hero-actions justify-center">
            <a href="#survey" class="btn btn-primary">{{ content.home_cta_research_btn_primary }}</a>
            <a href="#survey" class="btn btn-secondary">{{ content.home_cta_research_btn_secondary }}</a>
        </div>
        {% endif %}
    </div>
</section>

{% endblock %}

{% block taglines %}
<script id="page-taglines" type="application/json">
["Digital Lead Conversion","Digital Local Clients","Developer's Life Cycle","Digital Life Creation"]
</script>
{% endblock taglines %}

{% block extra_js %}
<script>
    (function () {
        var dlcEl = document.getElementById('brand-dlc');
        var taglineEl = document.getElementById('brand-tagline');

        var _tEl = document.getElementById('page-taglines');
        var taglines = _tEl ? JSON.parse(_tEl.textContent) : ['Digital Lead Conversion'];
        var current = 0;

        var T_HOLD = 1800;
        var T_FADE = 400;
        var T_PAUSE = 200;
        var T_TAGLINE = 320;
        var T_READ = 3200;
        var T_OUT = 340;
        var T_RESTORE = 300;

        function runCycle() {
            var tag = taglines[current];
            current = (current + 1) % taglines.length;

            setTimeout(function () {
                dlcEl.classList.add('dlc-out');
            }, T_HOLD);

            setTimeout(function () {
                taglineEl.textContent = tag;
                taglineEl.classList.add('tagline-in');
            }, T_HOLD + T_FADE + T_PAUSE);

            setTimeout(function () {
                taglineEl.classList.remove('tagline-in');
                taglineEl.classList.add('tagline-out');
            }, T_HOLD + T_FADE + T_PAUSE + T_TAGLINE + T_READ);

            setTimeout(function () {
                dlcEl.classList.remove('dlc-out');
                dlcEl.classList.add('dlc-in');
            }, T_HOLD + T_FADE + T_PAUSE + T_TAGLINE + T_READ + T_OUT * 0.5);

            var total = T_HOLD + T_FADE + T_PAUSE + T_TAGLINE + T_READ + T_OUT + T_RESTORE;
            setTimeout(function () {
                taglineEl.classList.remove('tagline-out');
                dlcEl.classList.remove('dlc-in');
                runCycle();
            }, total);
        }

        setTimeout(runCycle, 1200);
    })();
</script>

<script>
    {# Hero Torch + Z - row Parallax # }
    (function () {
        var hero = document.getElementById('hero-section');
        var torch = document.getElementById('hero-torch');
        var raf = null;
        var tx = 0, ty = 0;
        var cx = 0, cy = 0;

        hero.addEventListener('mousemove', function (e) {
            var r = hero.getBoundingClientRect();
            tx = e.clientX - r.left;
            ty = e.clientY - r.top;
            if (!raf) raf = requestAnimationFrame(animTorch);
        });

        hero.addEventListener('mouseleave', function () {
            torch.style.opacity = '0';
            if (raf) { cancelAnimationFrame(raf); raf = null; }
        });

        hero.addEventListener('mouseenter', function () {
            torch.style.opacity = '1';
        });

        function animTorch() {
            cx += (tx - cx) * 0.10;
            cy += (ty - cy) * 0.10;
            torch.style.left = cx + 'px';
            torch.style.top = cy + 'px';
            raf = requestAnimationFrame(animTorch);
        }

        var zRows = document.querySelectorAll('.z-row');
        zRows.forEach(function (row) {
            var visual = row.querySelector('.z-visual');
            if (!visual) return;

            row.addEventListener('mousemove', function (e) {
                var r = row.getBoundingClientRect();
                var nx = (e.clientX - r.left) / r.width - 0.5;
                var ny = (e.clientY - r.top) / r.height - 0.5;
                visual.style.transform = 'translate(' + (nx * 12) + 'px, ' + (ny * 8) + 'px)';
            });

            row.addEventListener('mouseleave', function () {
                visual.style.transform = 'translate(0, 0)';
            });
        });
    })();
</script>
{% endblock %}