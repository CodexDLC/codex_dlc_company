# ⚙️ Технические спецификации и оптимизация

## 1. Локализация и i18n (Архитектура семантических ключей)

Мы используем гибридную систему: строки интерфейса в `.po` файлах и маркетинговый контент в базе данных.

### 1.1. Система ключей (UI)

Доступ через `{% raw %}{% trans "key" %}{% endraw %}`. Никогда не вставляйте сырой текст напрямую в тег `trans`.

#### Группа: Навигация (`nav_`)

| Ключ | Контекст |
|:---|:---|
| `nav_main_home` | Главная страница |
| `nav_main_services` | Услуги |
| `nav_main_team` | Команда |
| `nav_main_contacts` | Контакты |
| `nav_footer_all_contacts` | Ссылка "Все контакты" в футере |
| `nav_legal_impressum` | Impressum |
| `nav_legal_privacy` | Datenschutz |

#### Группа: Кнопки и действия (`btn_`)

| Ключ | Контекст |
|:---|:---|
| `btn_cta_booking` | Основная кнопка записи |
| `btn_action_more` | "Подробнее" |
| `btn_form_submit` | Отправка формы |
| `btn_form_cancel` | Отмена |
| `btn_ui_toggle_footer` | Переключатель футера |

#### Группа: Услуги (`service_`)

| Ключ | Категория/Услуга |
|:---|:---|
| `service_cat_hair` | Волосы |
| `service_cat_nails` | Ногти |
| `service_item_manicure` | Маникюр |
| `service_item_coloring` | Окрашивание |

### 1.2. Контент в базе данных (`StaticTranslation`)

Для часто меняющихся текстов (Hero-секции, описания услуг) используется модель `StaticTranslation`.

*   **Доступ в шаблоне:** `{% raw %}{{ content.home_hero_title }}{% endraw %}`.
*   **Поддержка языков:** Поля `text_de`, `text_en`, `text_ru`, `text_uk` (через `modeltranslation`).

---

## 2. SEO и AI-оптимизация (AIO)

Сайт спроектирован для человеческого поиска (Google) и машинного поиска (LLM/AI).

### 2.1. AI-контекст (Специальное назначение)

Файлы `llms_*.txt` предоставляют AI-агентам (ChatGPT, Perplexity) точную информацию.

*   **Расположение:** `src/backend_django/templates/llms_[lang].txt`
*   **Контент:** Структура услуг, FAQ, способы оплаты, парковка и т.д.

### 2.2. Техническое SEO и Sitemap

*   **Динамический Sitemap:** XML генерируется через `core/sitemaps.py`. Включает динамические страницы услуг.
*   **Hreflang:** Автоматическая генерация в `includes/_hreflang_tags.html`.
*   **Canonicals:** Всегда указывают на основной домен, заданный в `CANONICAL_DOMAIN`.

### 2.3. Структурированные данные (JSON-LD)

Файл `_schema_local_business.html` реализует схему `LocalBusiness` с поддержкой:

*   **OpeningHours:** Динамически из БД.
*   **GeoCoordinates:** Для карт.
*   **OfferCatalog:** Глубокая вложенность категорий и услуг для Google Search.

---

## 3. Производительность и сборка

### 3.1. Оптимизация загрузки (Render-Blocking)

*   **Critical CSS:** Встраивается в тег `<head>` через `_critical_css.html`. Содержит стили хедера и Hero-секции.
*   **Async JS/CSS:** Основные файлы загружаются с `defer` или через полифиллы preload.
*   **Приоритет выборки (Fetch Priority):** Критически важные изображения (логотип, первый баннер) имеют атрибут `fetchpriority="high"`.

### 3.2. Изображения (Медиа)

*   **WebP:** Автоматическая конверсия всех загрузок.
*   **Lazy Loading:** Для всех изображений ниже первого экрана.

### 3.3. Интеграция HTMX

Используется для:

*   Динамических фильтров услуг.
*   Пошагового мастера записи (`booking_wizard`).
*   Обновления контента без полной перезагрузки страницы (через `hx-target`).

---

## 4. Конфигурация (`SiteSettings`)

Центральная панель управления в Django Admin:

*   **Соцсети:** Ссылки на Instagram, WhatsApp, Facebook.
*   **Analytics:** Контейнеры GA4 и GTM.
*   **Данные услуг:** Ценовые пороги, часы работы, координаты.
